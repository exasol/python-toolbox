Create a GitHub CLI mock

  $ cat > gh <<EOF
  > #!/usr/bin/sh
  > echo https://github.com/exasol/a-project/issues/`uuidgen`
  > EOF

  $ chmod u+x gh

  $ export PATH=`pwd`:${PATH}

Create test input

  $ cat > cves.jsonl <<EOF
  > {"cve": "CVE-2023-39410", "cwe": "CWE-502", "description": "When deserializing untrusted or corrupted data, it is possible for a reader to consume memory beyond the allowed constraints and thus lead to out of memory on the system.\n\nThis issue affects Java applications using Apache Avro Java SDK up to and including 1.11.2.  Users should update to apache-avro version 1.11.3 which addresses this issue.\n\n", "coordinates": "pkg:maven/org.apache.avro/avro@1.7.7", "references": ["https://ossindex.sonatype.org/vulnerability/CVE-2023-39410?component-type=maven&component-name=org.apache.avro%2Favro&utm_source=ossindex-client&utm_medium=integration&utm_content=1.8.1", "http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2023-39410", "https://github.com/apache/avro/pull/2432", "https://issues.apache.org/jira/browse/AVRO-3819", "https://lists.apache.org/thread/q142wj99cwdd0jo5lvdoxzoymlqyjdds"]}
  > {"cve": "CVE-2020-36641", "cwe": "CWE-611", "description": "A vulnerability classified as problematic was found in gturri aXMLRPC up to 1.12.0. This vulnerability affects the function ResponseParser of the file src/main/java/de/timroes/axmlrpc/ResponseParser.java. The manipulation leads to xml external entity reference. Upgrading to version 1.12.1 is able to address this issue. The patch is identified as ad6615b3ec41353e614f6ea5fdd5b046442a832b. It is recommended to upgrade the affected component. VDB-217450 is the identifier assigned to this vulnerability.\n\nSonatype's research suggests that this CVE's details differ from those defined at NVD. See https://ossindex.sonatype.org/vulnerability/CVE-2020-36641 for details", "coordinates": "pkg:maven/fr.turri/aXMLRPC@1.13.0", "references": ["https://ossindex.sonatype.org/vulnerability/CVE-2020-36641?component-type=maven&component-name=fr.turri%2FaXMLRPC&utm_source=ossindex-client&utm_medium=integration&utm_content=1.8.1", "http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2020-36641", "https://www.tenable.com/cve/CVE-2020-36641"]}
  > EOF

Run test case

  $ tbx security cve create cves.jsonl 2> /dev/null | grep .
  https://github.com/exasol/a-project/issues/[a-f0-9\-]+ (re)
  https://github.com/exasol/a-project/issues/[a-f0-9\-]+ (re)
